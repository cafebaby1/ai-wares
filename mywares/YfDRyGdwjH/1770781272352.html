// 等待DOM加载完成
document.addEventListener('DOMContentLoaded', () => {
  const saveBtn = document.getElementById('saveBtn');
  const getBtn = document.getElementById('getBtn');
  const inputVal = document.getElementById('inputVal');
  const storageValue = document.getElementById('storageValue');

  // 保存值到chrome.storage.local
  saveBtn.addEventListener('click', async () => {
    const val = inputVal.value.trim();
    if (!val) {
      alert('请输入内容');
      return;
    }
    try {
      // 异步保存
      await chrome.storage.local.set({ "popupKey": val });
      alert('保存成功');
      inputVal.value = '';
    } catch (error) {
      console.error('保存失败：', error);
      alert('保存失败');
    }
  });

  // 从chrome.storage.local读取值
  getBtn.addEventListener('click', async () => {
    try {
      // 异步读取
      const data = await chrome.storage.local.get("popupKey");
      storageValue.textContent = data.popupKey || '暂无数据';
    } catch (error) {
      console.error('读取失败：', error);
      storageValue.textContent = '读取失败';
    }
  });
});